%   ファイルおよびフォルダ名(ディレクトリ名)の表記には\verbコマンドを用いる．
%   引数を持たないコマンドは基本的に波括弧で囲う．(e.g. {\hoge})
%   一行あたりの最大文字数は135文字を目安に折り返す．

\addtocounter{page}{-1}

%%%%%%%%%%%%%%%%%%%%%% §1 %%%%%%%%%%%%%%%%%%%%%%
\chapter{インストール}

%%%%%%%%%%%%%%%%%%%%% §1.1 %%%%%%%%%%%%%%%%%%%%%
\section{{\TeX}のインストール}

{\ketcindy}は{\TeX}をベースとした教材作成支援システムとして開発された．
そこで，{\ketcindy}をインストールする前に，Windowsにおける{\TeX}のインストール手順を説明する．
{\TeX}とは，コンピュータ上で出版物を作成できる組版システムのことである．
{\TeX}のフルスペック版は{\TeX}Liveとして纏められたおり，毎年アップデートされ，最新版は{\TeX}Live2023である．

ところで，{\ketcindy}ではフルスペックの{\TeX}を必要としていないため，最低限必要な部分だけ組み込んだ簡易版としてKeT{\TeX}が開発された．
KeT{\TeX}は1.6GB程度とサイズが小さく，日本語で文書を作成する程度なら全く問題ない．
フルスペック版に拘らなければ，ディスク容量を軽減できるため，KeT{\TeX}がお勧めである．

%%%%%%%%%%%%%%%%%%%% §1.1.1 %%%%%%%%%%%%%%%%%%%%
\subsection{{\TeX}Liveの場合}

\begin{enumerate}
    \item \url{https://www.tug.org}にアクセスする
    \item 右ペインにあるSoftwareからTeX Liveを選択する
    \item install on Windowsを選択する
    \item \verb|install-tl-windows.exe|を選択する
    \item exeファイルを管理者として実行\footnote{右クリックメニューから[管理者として実行]を選択}する
    \item インストーラに従いインストールを完了させる
\end{enumerate}

インストール先にCドライブ直下を指定すると{\ketcindy}のインストール時に楽である．
インターネット上から膨大な量のファイルをダウンロードするため，かなりの時間を要するはずである．

%%%%%%%%%%%%%%%%%%%% §1.1.2 %%%%%%%%%%%%%%%%%%%%
\subsection{KeT{\TeX}の場合}

\begin{enumerate}
    \item \url{https://github.com/ketpic/kettex}にアクセスする
    \item 右ペインからReleasesを選択する
    \item \verb|KeTTeX-windows-20230320.zip|を選択する
    \item ダウンロードしたzipファイルをCドライブ直下に移動する
    \item zipファイルを解凍しする
    \item 中にある\verb|kettexinst.cmd|を管理者として実行する
    \item インストーラに従いインストールを完了させる
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%% §1.2 %%%%%%%%%%%%%%%%%%%%%
\section{{\ketcindy}のインストール}

{\ketcindy}は，動的幾何学ソフトCinderellaを用いて図形を描き，{\TeX}の図版ファイルを作るためのシステムである．
gccやMaximaと連携することで，より複雑な処理をすることも可能である．

ここでは，{\ketcindy}本体だけでなく，上述した連携可能ソフトウェアも含めたインストール手順を説明する．

必要なソフトウェア\footnote{太字のものは必須}およびURLの一覧を下に示す．

\begin{table}[h]
    \centering
    \caption{ソフトウェア一覧}
    \label{tab:download}
    \begin{tabular}{c||l}
        \textbf{\ketcindy}   & \url{https://github.com/ketpic/ketcindy}\\
        \textbf{R}           & \url{https://cran.r-project.org/}\\
        \textbf{Cinderella}  & \url{https://cinderella.de/tiki-index.php}\\
        Maxima      & \url{https://maxima.sourceforge.io/}\\
        MinGW-w64   & \url{https://www.mingw-w64.org/}\\
        emath       & \url{http://emath.s40.xrea.com/}\\
        SumatraPDF  & \url{https://www.sumatrapdfreader.org/free-pdf-reader}
    \end{tabular}
\end{table}

%%%%%%%%%%%%%%%%%%%% §1.2.1 %%%%%%%%%%%%%%%%%%%%
\subsection{Windowsの場合}

ここでは，64bit版Windows 11 Pro (22H2)における{\ketcindy}のインストール手順を説明する．
特に説明されていない限り，インストール先フォルダは\verb|C:\Program Files|または\verb|C:\Program Files (x86)|を推奨する．

\subsubsection{{\ketcindy}本体のインストール}
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item 右ペインからReleasesを選択する
    \item Source code (zip)を選択する
    \item ダウンロードしたzipファイルをCドライブ直下に移動する
    \item zipファイルを解凍する
    \item 解凍されたフォルダ名から「\verb|-|」（ハイフン）を取り除く
\end{enumerate}

\subsubsection{Rのインストール}
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item Download R for Windows→baseと進む
    \item Download R-4.2.3 for Windowsを選択する
    \item ダウンロードしたexeファイルを実行する
    \item インストーラに従いインストールを完了させる
\end{enumerate}

\subsubsection{Cinderellaのインストール}
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item 右ペインから ダウンロード を選択する
    \item installer for 64bitを選択する
    \item ダウンロードしたexeファイルを管理者として実行する
    \item インストーラに従いインストールを完了させる
\end{enumerate}

\subsubsection{Maximaのインストール}
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item 右ペインからDownloadsを選択する
    \item Installation of Maxima in Windows→5.46.0-Windowsと進む
    \item \verb|maxima-5.46.0-win64.exe|を選択する
    \item ダウンロードしたexeファイルを管理者として実行する
    \item インストーラに従いインストールを完了させる
\end{enumerate}

\subsubsection{MinGW-w64のインストール}
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item 左ペインからDownloadsを選択する
    \item 右ペインからMingw-buildsを選択する
    \item GitHubを選択する
    \item \verb|x86_64-12.2.0-release-posix-seh-ucrt-rt_v10-rev2.7z|を選択する
    \item ダウンロードした7zファイルを解凍する
    \item 中にある\verb|bin|フォルダの絶対パスをシステム環境変数として登録する
\end{enumerate}

\subsubsection{emathのインストール}
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item 入口→丸ごとパック と進む
    \item \verb|emathf051107c.zip|を選択する
    \item ダウンロードしたzipファイルを解凍する
    \item 中にある\verb|sty.zip|を解凍する
    \item \verb|sty|フォルダを{\ketcindy}フォルダ
          \cprotect\footnote{上の手順に従っている場合，\verb|ketcindyx.x.x|（\verb|x|はバージョン）}内にある\verb|doc\foremathJ|に入れる
\end{enumerate}

\subsubsection{PDFビューアのインストール}
ここではSumatraPDFをインストールする．Adobe Acrobat等のPDFビューアも使用可能だが，
PDFファイルを開いている間にファイルがロックされない\footnote{PDFファイルを開いていても外部でファイルの編集ができる}ため，
特にこだわりがなければSumatraPDFがお薦めである．
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item Downloadを選択する
    \item \verb|SumatraPDF-3.4.6-64-install.exe|を選択する
    \item ダウンロードしたexeファイルを実行する
    \item インストール先フォルダを\verb|C:\Program Files\SumatraPDF|に変更する
    \item インストーラに従いインストールを完了させる
\end{enumerate}

%%%%%%%%%%%%%%%%%%%% §1.2.2 %%%%%%%%%%%%%%%%%%%%
\subsection{Macintoshの場合}

ここでは，Apple M2 MacBook Air (Ventura 13.1)における{\ketcindy}のインストール手順を説明する．

%ここからMac向けに改修
\subsubsection{{\ketcindy}本体のインストール}
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item 右ペインからReleasesを選択する
    \item Source code (tar.gz)を選択する
    \item ダウンロードしたtar.gzファイルを展開する
\end{enumerate}

\subsubsection{Rのインストール}
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item Download R for macOSを選択する
    \item \verb|R-4.2.3-arm64.pkg|を選択する
    \item ダウンロードしたpkgファイルを実行する
    \item インストーラに従いインストールを完了させる
\end{enumerate}

\subsubsection{Cinderellaのインストール}
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item 右ペインから ダウンロード を選択する
    \item disk imageを選択する
    \item ダウンロードしたdmgファイル内にある\verb|Cinderella|を左ペインにある アプリケーション に入れる
\end{enumerate}

\newpage
\subsubsection{Maximaのインストール}
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item 右ペインからDownloadsを選択する
    \item Maxima-MacOS download section→5.43.0-MacOSXと進む
    \item \verb|Maxima-5.43.0-VTK-macOS.dmg|を選択する
    \item ダウンロードしたdmgファイル内にある\verb|Maxima|を アプリケーション に入れる
    \item Finderから アプリケーション 内にあるMaximaを探し，controlキーを押しながらクリックする
    \item 開く を選択し，セキュリティ警告を消す
\end{enumerate}

\subsubsection{gccのインストール}
\begin{enumerate}
    \item ターミナルから次のコマンドを実行する
          \begin{lstlisting}
  $ sudo xcode-select --install
          \end{lstlisting}
\end{enumerate}

\subsubsection{emathのインストール}
\begin{enumerate}
    \item 表\ref{tab:download}のURLにアクセスする
    \item 入口→丸ごとパック と進む
    \item \verb|emathf051107c.zip|を選択する
    \item ダウンロードしたzipファイルを解凍する
    \item 中にある\verb|sty.zip|を解凍する
    \item \verb|sty|フォルダを{\ketcindy}フォルダ
    \cprotect\footnote{上の手順に従っている場合，\verb|ketcindyx.x.x|（\verb|x|はバージョン）}内にある\verb|doc\foremathJ|に入れる
\end{enumerate}
